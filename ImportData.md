# ImportDataFromFile
```
&НаСервере
Процедура ЗагрузитьДанныеНаСервере(Результат, ДопПараметр)  Экспорт
	Если Не (Результат=Неопределено) Тогда
		//Файл выбран
		СсылкаНаФайл=Результат[0];
	Иначе
		Сообщить("Файл не выбран. Необходимо выбрать файл");
		Возврат;
	КонецЕсли;
	//Обработка табличного документа
	ТабДок=Новый ТабличныйДокумент;
	ТабДок.Прочитать(СсылкаНаФайл);
	Для Строка=2 По ТабДок.ВысотаТаблицы Цикл
		ЭлементМатериал=Справочники.Материалы.СоздатьЭлемент();
		ЭлементМатериал.Наименование=ТабДок.Область(Строка,2).Текст;
		ЭлементМатериал.Код=ТабДок.Область(Строка, 1).Текст;
		ЭлементМатериал.Длина=ТабДок.Область(Строка,4).Текст;    
		ЭлементМатериал.Количество=ТабДок.Область(Строка, 5).Текст;
		ЕдиницаИзмеренияТабДока=ТабДок.Область(Строка, 3).Текст; 
		ТипМатериалаТабДока=ТабДок.Область(Строка, 6).Текст;
		Если Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдиницаИзмеренияТабДока, Истина)=Справочники.ЕдиницыИзмерения.ПустаяСсылка()ТОгда
			ЭлементЕдИзм=Справочники.ЕдиницыИзмерения.СоздатьЭлемент();
			ЭлементЕдИзм.Наименование=ЕдиницаИзмеренияТабДока;
			ЭлементЕдИзм.Записать();
			Сообщить("В справочник Единицы измерения добавлена новая запись " + ЭлементЕдИзм.Наименование);
		КонецЕсли;     
		Если Справочники.ТипыМатериалов.НайтиПоНаименованию(ТипМатериалаТабДока, Истина)=Справочники.ТипыМатериалов.ПустаяСсылка()ТОгда
			ЭлементТМ=Справочники.ТипыМатериалов.СоздатьЭлемент();
			ЭлементТМ.Наименование=ТипМатериалаТабДока;
			ЭлементТМ.Записать();
			Сообщить("В справочник Типы фурнитуры добавлена новая запись " + ЭлементТМ.Наименование);
		КонецЕсли;
		ЭлементМатериал.ТипМатериала=Справочники.ТипыМатериалов.НайтиПоНаименованию(ТипМатериалаТабДока, Истина);
		ЭлементМатериал.ЕдиницаИзмерения=Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдиницаИзмеренияТабДока, Истина);
		ЭлементМатериал.Цена=ТабДок.Область(Строка, 7).Текст;  
		ЭлементМатериал.ГОСТ=ТабДок.Область(Строка, 8).Текст;
		ЭлементМатериал.Записать();
		Сообщить("В справочник Материалы добавлена запись");
	КонецЦикла;

КонецПроцедуры

&НаКлиенте
Процедура ЗагрузитьДанные(Команда)
	ВыборФайла=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.МножественныйВыбор=Ложь;
	ВыборФайла.Фильтр=" Табличные документы *.xlsx| *.xlsx";
	ВыборФайла.Показать( Новый ОписаниеОповещения("ЗагрузитьДанныеНаСервере", ЭтотОбъект, Новый Структура));
КонецПроцедуры

```
